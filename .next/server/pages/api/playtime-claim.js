"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/playtime-claim";
exports.ids = ["pages/api/playtime-claim"];
exports.modules = {

/***/ "firebase/app":
/*!*******************************!*\
  !*** external "firebase/app" ***!
  \*******************************/
/***/ ((module) => {

module.exports = import("firebase/app");;

/***/ }),

/***/ "firebase/firestore":
/*!*************************************!*\
  !*** external "firebase/firestore" ***!
  \*************************************/
/***/ ((module) => {

module.exports = import("firebase/firestore");;

/***/ }),

/***/ "(api)/./pages/api/playtime-claim.ts":
/*!*************************************!*\
  !*** ./pages/api/playtime-claim.ts ***!
  \*************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var firebase_app__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/app */ \"firebase/app\");\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_app__WEBPACK_IMPORTED_MODULE_0__, firebase_firestore__WEBPACK_IMPORTED_MODULE_1__]);\n([firebase_app__WEBPACK_IMPORTED_MODULE_0__, firebase_firestore__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\nconst firebaseConfig = {\n    apiKey: process.env.API_KEY,\n    authDomain: process.env.authDomain,\n    projectId: process.env.projectId,\n    storageBucket: process.env.storageBucket,\n    messagingSenderId: process.env.messagingSenderId,\n    appId: process.env.appId,\n    measurementId: process.env.measurementId\n};\nconst app = (0,firebase_app__WEBPACK_IMPORTED_MODULE_0__.initializeApp)(firebaseConfig);\nconst db = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.getFirestore)(app);\nasync function handler(req, res) {\n    const { walletAddress , playtime , timestamp , platformWalletAddress ,  } = req.body;\n    // Validate input data\n    if (!walletAddress || !playtime || !timestamp) {\n        return res.status(400).json({\n            message: \"Missing required data\"\n        });\n    }\n    const historyCollectionRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.collection)(db, \"users\", walletAddress, \"history\");\n    try {\n        // Add the current playtime to the user's history\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.addDoc)(historyCollectionRef, {\n            playtime,\n            timestamp: firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.Timestamp.fromDate(new Date(timestamp))\n        });\n        const historyQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.query)(historyCollectionRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.orderBy)(\"timestamp\", \"desc\"));\n        const historySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.getDocs)(historyQuery);\n        if (historySnapshot.size > 1) {\n            const historyDocs = historySnapshot.docs;\n            const lastPlayed = historyDocs[0].data();\n            const secondLastPlayed = historyDocs[1].data();\n            const historyArray = historyDocs.map((doc)=>{\n                const data = doc.data();\n                return {\n                    ...data,\n                    timestamp: data.timestamp.toDate().toISOString()\n                };\n            });\n            const playtimeDifference = lastPlayed.playtime - secondLastPlayed.playtime;\n            res.status(200).json({\n                playtimeDifference,\n                historyArray,\n                platformWalletAddress\n            });\n        } else {\n            res.status(200).json({\n                success: true,\n                message: \"Playtime added\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error adding playtime to history:\", error);\n        res.status(500).json({\n            message: \"Error processing request\"\n        });\n    }\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvcGxheXRpbWUtY2xhaW0udHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTRDO0FBV2pCO0FBSTNCLEtBQUssQ0FBQ1EsY0FBYyxHQUFHLENBQUM7SUFDdEJDLE1BQU0sRUFBRUMsT0FBTyxDQUFDQyxHQUFHLENBQUNDLE9BQU87SUFDM0JDLFVBQVUsRUFBRUgsT0FBTyxDQUFDQyxHQUFHLENBQUNFLFVBQVU7SUFDbENDLFNBQVMsRUFBRUosT0FBTyxDQUFDQyxHQUFHLENBQUNHLFNBQVM7SUFDaENDLGFBQWEsRUFBRUwsT0FBTyxDQUFDQyxHQUFHLENBQUNJLGFBQWE7SUFDeENDLGlCQUFpQixFQUFFTixPQUFPLENBQUNDLEdBQUcsQ0FBQ0ssaUJBQWlCO0lBQ2hEQyxLQUFLLEVBQUVQLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDTSxLQUFLO0lBQ3hCQyxhQUFhLEVBQUVSLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDTyxhQUFhO0FBQzFDLENBQUM7QUFFRCxLQUFLLENBQUNDLEdBQUcsR0FBR25CLDJEQUFhLENBQUNRLGNBQWM7QUFDeEMsS0FBSyxDQUFDWSxFQUFFLEdBQUduQixnRUFBWSxDQUFDa0IsR0FBRztBQU9aLGVBQWVFLE9BQU8sQ0FDbkNDLEdBQW1CLEVBQ25CQyxHQUFvQixFQUNwQixDQUFDO0lBQ0QsS0FBSyxDQUFDLENBQUMsQ0FDTEMsYUFBYSxHQUNiQyxRQUFRLEdBQ1JDLFNBQVMsR0FDVEMscUJBQXFCLElBQ3ZCLENBQUMsR0FLR0wsR0FBRyxDQUFDTSxJQUFJO0lBRVosRUFBc0I7SUFDdEIsRUFBRSxHQUFHSixhQUFhLEtBQUtDLFFBQVEsS0FBS0MsU0FBUyxFQUFFLENBQUM7UUFDOUMsTUFBTSxDQUFDSCxHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLEVBQUVDLElBQUksQ0FBQyxDQUFDO1lBQUNDLE9BQU8sRUFBRSxDQUF1QjtRQUFDLENBQUM7SUFDbEUsQ0FBQztJQUVELEtBQUssQ0FBQ0Msb0JBQW9CLEdBQUc5Qiw4REFBVSxDQUNyQ2tCLEVBQUUsRUFDRixDQUFPLFFBQ1BJLGFBQWEsRUFDYixDQUFTO0lBR1gsR0FBRyxDQUFDLENBQUM7UUFDSCxFQUFpRDtRQUNqRCxLQUFLLENBQUNyQiwwREFBTSxDQUFDNkIsb0JBQW9CLEVBQUUsQ0FBQztZQUNsQ1AsUUFBUTtZQUNSQyxTQUFTLEVBQUVuQixrRUFBa0IsQ0FBQyxHQUFHLENBQUMyQixJQUFJLENBQUNSLFNBQVM7UUFDbEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxLQUFLLENBQUNTLFlBQVksR0FBRzlCLHlEQUFLLENBQ3hCMkIsb0JBQW9CLEVBQ3BCMUIsMkRBQU8sQ0FBQyxDQUFXLFlBQUUsQ0FBTTtRQUU3QixLQUFLLENBQUM4QixlQUFlLEdBQUcsS0FBSyxDQUFDaEMsMkRBQU8sQ0FBQytCLFlBQVk7UUFFbEQsRUFBRSxFQUFFQyxlQUFlLENBQUNDLElBQUksR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUM3QixLQUFLLENBQUNDLFdBQVcsR0FBR0YsZUFBZSxDQUFDRyxJQUFJO1lBQ3hDLEtBQUssQ0FBQ0MsVUFBVSxHQUFHRixXQUFXLENBQUMsQ0FBQyxFQUFFRyxJQUFJO1lBQ3RDLEtBQUssQ0FBQ0MsZ0JBQWdCLEdBQUdKLFdBQVcsQ0FBQyxDQUFDLEVBQUVHLElBQUk7WUFFNUMsS0FBSyxDQUFDRSxZQUFZLEdBQUdMLFdBQVcsQ0FBQ00sR0FBRyxFQUFFQyxHQUFHLEdBQUssQ0FBQztnQkFDN0MsS0FBSyxDQUFDSixJQUFJLEdBQUdJLEdBQUcsQ0FBQ0osSUFBSTtnQkFDckIsTUFBTSxDQUFDLENBQUM7dUJBQ0hBLElBQUk7b0JBQ1BmLFNBQVMsRUFBRWUsSUFBSSxDQUFDZixTQUFTLENBQUNvQixNQUFNLEdBQUdDLFdBQVc7Z0JBQ2hELENBQUM7WUFDSCxDQUFDO1lBRUQsS0FBSyxDQUFDQyxrQkFBa0IsR0FDdEJSLFVBQVUsQ0FBQ2YsUUFBUSxHQUFHaUIsZ0JBQWdCLENBQUNqQixRQUFRO1lBQ2pERixHQUFHLENBQ0FNLE1BQU0sQ0FBQyxHQUFHLEVBQ1ZDLElBQUksQ0FBQyxDQUFDO2dCQUFDa0Isa0JBQWtCO2dCQUFFTCxZQUFZO2dCQUFFaEIscUJBQXFCO1lBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdkUsQ0FBQyxNQUFNLENBQUM7WUFDTkosR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxFQUFFQyxJQUFJLENBQUMsQ0FBQztnQkFBQ21CLE9BQU8sRUFBRSxJQUFJO2dCQUFFbEIsT0FBTyxFQUFFLENBQWdCO1lBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckUsQ0FBQztJQUNILENBQUMsQ0FBQyxLQUFLLEVBQUVtQixLQUFLLEVBQUUsQ0FBQztRQUNmQyxPQUFPLENBQUNELEtBQUssQ0FBQyxDQUFtQyxvQ0FBRUEsS0FBSyxDQUFDLENBQUM7UUFDMUQzQixHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLEVBQUVDLElBQUksQ0FBQyxDQUFDO1lBQUNDLE9BQU8sRUFBRSxDQUEwQjtRQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc29sYW5hLWludHJvLWZyb250ZW5kLy4vcGFnZXMvYXBpL3BsYXl0aW1lLWNsYWltLnRzPzY4MGEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5pdGlhbGl6ZUFwcCB9IGZyb20gXCJmaXJlYmFzZS9hcHBcIjtcbmltcG9ydCB7XG4gIGdldEZpcmVzdG9yZSxcbiAgY29sbGVjdGlvbixcbiAgYWRkRG9jLFxuICBnZXREb2NzLFxuICBxdWVyeSxcbiAgb3JkZXJCeSxcbiAgbGltaXQsXG4gIHdoZXJlLFxuICBUaW1lc3RhbXAsXG59IGZyb20gXCJmaXJlYmFzZS9maXJlc3RvcmVcIjtcblxuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSBcIm5leHRcIjtcblxuY29uc3QgZmlyZWJhc2VDb25maWcgPSB7XG4gIGFwaUtleTogcHJvY2Vzcy5lbnYuQVBJX0tFWSxcbiAgYXV0aERvbWFpbjogcHJvY2Vzcy5lbnYuYXV0aERvbWFpbixcbiAgcHJvamVjdElkOiBwcm9jZXNzLmVudi5wcm9qZWN0SWQsXG4gIHN0b3JhZ2VCdWNrZXQ6IHByb2Nlc3MuZW52LnN0b3JhZ2VCdWNrZXQsXG4gIG1lc3NhZ2luZ1NlbmRlcklkOiBwcm9jZXNzLmVudi5tZXNzYWdpbmdTZW5kZXJJZCxcbiAgYXBwSWQ6IHByb2Nlc3MuZW52LmFwcElkLFxuICBtZWFzdXJlbWVudElkOiBwcm9jZXNzLmVudi5tZWFzdXJlbWVudElkLFxufTtcblxuY29uc3QgYXBwID0gaW5pdGlhbGl6ZUFwcChmaXJlYmFzZUNvbmZpZyk7XG5jb25zdCBkYiA9IGdldEZpcmVzdG9yZShhcHApO1xuXG5leHBvcnQgdHlwZSBIaXN0b3J5RW50cnkgPSB7XG4gIHBsYXl0aW1lOiBudW1iZXI7XG4gIHRpbWVzdGFtcDogVGltZXN0YW1wO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCxcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2Vcbikge1xuICBjb25zdCB7XG4gICAgd2FsbGV0QWRkcmVzcyxcbiAgICBwbGF5dGltZSxcbiAgICB0aW1lc3RhbXAsXG4gICAgcGxhdGZvcm1XYWxsZXRBZGRyZXNzLFxuICB9OiB7XG4gICAgd2FsbGV0QWRkcmVzczogc3RyaW5nO1xuICAgIHBsYXl0aW1lOiBudW1iZXI7XG4gICAgdGltZXN0YW1wOiBzdHJpbmc7XG4gICAgcGxhdGZvcm1XYWxsZXRBZGRyZXNzOiBzdHJpbmc7XG4gIH0gPSByZXEuYm9keTtcblxuICAvLyBWYWxpZGF0ZSBpbnB1dCBkYXRhXG4gIGlmICghd2FsbGV0QWRkcmVzcyB8fCAhcGxheXRpbWUgfHwgIXRpbWVzdGFtcCkge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6IFwiTWlzc2luZyByZXF1aXJlZCBkYXRhXCIgfSk7XG4gIH1cblxuICBjb25zdCBoaXN0b3J5Q29sbGVjdGlvblJlZiA9IGNvbGxlY3Rpb24oXG4gICAgZGIsXG4gICAgXCJ1c2Vyc1wiLFxuICAgIHdhbGxldEFkZHJlc3MsXG4gICAgXCJoaXN0b3J5XCJcbiAgKTtcblxuICB0cnkge1xuICAgIC8vIEFkZCB0aGUgY3VycmVudCBwbGF5dGltZSB0byB0aGUgdXNlcidzIGhpc3RvcnlcbiAgICBhd2FpdCBhZGREb2MoaGlzdG9yeUNvbGxlY3Rpb25SZWYsIHtcbiAgICAgIHBsYXl0aW1lLFxuICAgICAgdGltZXN0YW1wOiBUaW1lc3RhbXAuZnJvbURhdGUobmV3IERhdGUodGltZXN0YW1wKSksXG4gICAgfSk7XG5cbiAgICBjb25zdCBoaXN0b3J5UXVlcnkgPSBxdWVyeShcbiAgICAgIGhpc3RvcnlDb2xsZWN0aW9uUmVmLFxuICAgICAgb3JkZXJCeShcInRpbWVzdGFtcFwiLCBcImRlc2NcIilcbiAgICApO1xuICAgIGNvbnN0IGhpc3RvcnlTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MoaGlzdG9yeVF1ZXJ5KTtcblxuICAgIGlmIChoaXN0b3J5U25hcHNob3Quc2l6ZSA+IDEpIHtcbiAgICAgIGNvbnN0IGhpc3RvcnlEb2NzID0gaGlzdG9yeVNuYXBzaG90LmRvY3M7XG4gICAgICBjb25zdCBsYXN0UGxheWVkID0gaGlzdG9yeURvY3NbMF0uZGF0YSgpIGFzIEhpc3RvcnlFbnRyeTtcbiAgICAgIGNvbnN0IHNlY29uZExhc3RQbGF5ZWQgPSBoaXN0b3J5RG9jc1sxXS5kYXRhKCkgYXMgSGlzdG9yeUVudHJ5O1xuXG4gICAgICBjb25zdCBoaXN0b3J5QXJyYXkgPSBoaXN0b3J5RG9jcy5tYXAoKGRvYykgPT4ge1xuICAgICAgICBjb25zdCBkYXRhID0gZG9jLmRhdGEoKSBhcyBIaXN0b3J5RW50cnk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgICB0aW1lc3RhbXA6IGRhdGEudGltZXN0YW1wLnRvRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcGxheXRpbWVEaWZmZXJlbmNlID1cbiAgICAgICAgbGFzdFBsYXllZC5wbGF5dGltZSAtIHNlY29uZExhc3RQbGF5ZWQucGxheXRpbWU7XG4gICAgICByZXNcbiAgICAgICAgLnN0YXR1cygyMDApXG4gICAgICAgIC5qc29uKHsgcGxheXRpbWVEaWZmZXJlbmNlLCBoaXN0b3J5QXJyYXksIHBsYXRmb3JtV2FsbGV0QWRkcmVzcyB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlOiBcIlBsYXl0aW1lIGFkZGVkXCIgfSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBhZGRpbmcgcGxheXRpbWUgdG8gaGlzdG9yeTpcIiwgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogXCJFcnJvciBwcm9jZXNzaW5nIHJlcXVlc3RcIiB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImluaXRpYWxpemVBcHAiLCJnZXRGaXJlc3RvcmUiLCJjb2xsZWN0aW9uIiwiYWRkRG9jIiwiZ2V0RG9jcyIsInF1ZXJ5Iiwib3JkZXJCeSIsIlRpbWVzdGFtcCIsImZpcmViYXNlQ29uZmlnIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIkFQSV9LRVkiLCJhdXRoRG9tYWluIiwicHJvamVjdElkIiwic3RvcmFnZUJ1Y2tldCIsIm1lc3NhZ2luZ1NlbmRlcklkIiwiYXBwSWQiLCJtZWFzdXJlbWVudElkIiwiYXBwIiwiZGIiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwid2FsbGV0QWRkcmVzcyIsInBsYXl0aW1lIiwidGltZXN0YW1wIiwicGxhdGZvcm1XYWxsZXRBZGRyZXNzIiwiYm9keSIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiaGlzdG9yeUNvbGxlY3Rpb25SZWYiLCJmcm9tRGF0ZSIsIkRhdGUiLCJoaXN0b3J5UXVlcnkiLCJoaXN0b3J5U25hcHNob3QiLCJzaXplIiwiaGlzdG9yeURvY3MiLCJkb2NzIiwibGFzdFBsYXllZCIsImRhdGEiLCJzZWNvbmRMYXN0UGxheWVkIiwiaGlzdG9yeUFycmF5IiwibWFwIiwiZG9jIiwidG9EYXRlIiwidG9JU09TdHJpbmciLCJwbGF5dGltZURpZmZlcmVuY2UiLCJzdWNjZXNzIiwiZXJyb3IiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/playtime-claim.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/playtime-claim.ts"));
module.exports = __webpack_exports__;

})();